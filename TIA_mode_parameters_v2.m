function TIA_Param = TIA_mode_parameters_v2(varargin)
%     get CANPA/TIA parameters for different modes.
%         Mode           #Mass        #Wi       #Phi       #Theta    #time     
%         5 [Default1]      9               64        24              9           2           
%         6 [High en]       1               90        24              9           4           
%         7 [High ang]     1               64        24             15          4           
%         8 [High mass]   9               48         24               9           2
%    %    9 [exact]         9            64          12              9           24
%     Example: 
%         TIA_Param = tw2.TIA_mode_parameters(mode)
%     mode should be a number between 5 and 8
%
%     1st version 2025/05/25  Binbin
%     2st version 2025/06/2  dzj 
%           update [mode5:circle time; N_circle; gating_tof_64E9M; gating_timing_64E9M ]
%           add [case6part; case7part; case8; gating_tof_48E9M; gating_timing_48E9M  ]

    if (nargin ~= 1)
      nargin
      help tw2.TIA_mode_parameters;
      return;
    end
    
    mode  = varargin{1};
    if(ischar(mode))
        mode = str2num(mode);
    end
    if(mode > 8 || mode < 5)
        disp('CANPA/TIA mode input is not correct.')
        help tw2.TIA_mode_parameters;
        return;
    end
    
    
       switch mode
        case 5   % default mode 5-------------------------------------------------------
            TIA_Param.nmass     = 9;
            TIA_Param.nenergy   = 64 ;
            TIA_Param.naz       = 24;
            TIA_Param.npl       = 9;
            TIA_Param.slot_time = 3.472222222;        % ms
            TIA_Param.mass_num  = [1,2,4,8,16,32,44,56,70];  % m/q, the last one is 60-70
            
            % set phi and theta (phi is constant here)
            dphi = 360/TIA_Param.naz; dtht = 90/TIA_Param.npl;
            tht_lower = 0:dtht:90-dtht; 
            tht_upper = tht_lower + dtht;
            theta = (tht_upper+tht_lower)/2;
            phi_lower = 0 : dphi : 360-dphi; 
            phi_upper = phi_lower+dphi;
            phi = (phi_upper+phi_lower)/2;
            TIA_Param.theta = theta;
            TIA_Param.dtht = dtht;
            TIA_Param.tht_lower = tht_lower;
            TIA_Param.tht_upper = tht_upper;
            TIA_Param.phi = phi;
            TIA_Param.dphi = dphi;
            TIA_Param.phi_lower = phi_lower;
            TIA_Param.phi_upper = phi_upper;
            
            % set energy table  (energy and V_ESA are from the payload team)   
            energy = [2.79  3.23 3.75 4.35 5.04 5.84 6.77 7.84 9.09 10.54 12.22 14.16 16.42 19.03 22.06 25.57 29.64 34.35 39.82 ... 
                             46.16 53.50 62.02 71.89 83.33 96.59 111.96 129.78 150.43 174.37 202.12 234.28 271.57 314.79 364.89 ...
                             422.96 490.27 568.29 658.73 763.57 885.08 1025.94 1189.22 1378.47 1597.85 1852.14 2146.90 2488.57 ...
                             2884.62 3343.69 3875.83 4492.65 5207.63 6036.40 6997.07 8110.62 9401.39 10897.58 12631.88 14642.19 ...
                             16972.43 19673.51 22804.47 26433.70 30640.50 ];
            V_ESA = [0.50 0.58 0.67 0.78 0.90 1.05 1.21 1.41 1.63 1.89 2.19 2.54 2.95 3.42 3.96 4.59 5.32 6.17 7.15 8.28 9.60 ... 
                            11.13 12.90 14.96 17.34 20.10 23.29 27.00 31.30 36.28 42.05 48.75 56.50 65.50 75.92 88.00 102.01 118.24 ... 
                            137.06 158.87 184.16 213.47 247.44 286.82 332.46 385.37 446.70 517.79 600.20 695.71 806.43 934.78  ...
                            1083.54 1255.98 1455.86 1687.56 1956.13 2267.44 2628.29 3046.57 3531.42 4093.42 4744.87 5500.00 ];
            nenergy = TIA_Param.nenergy;
            energyall = log10((energy));
            temp0 = 2*energyall(1)-energyall(2);
            tempe = 2*energyall(end)-energyall(end-1);
            energyall = [temp0 energyall tempe];
            diffenall = diff(energyall);
            energyupper = 10.^(log10(energy)+diffenall(2:1:nenergy+1)/2);
            energylower = 10.^(log10(energy)-diffenall(1:1:nenergy)/2);   
            TIA_Param.Wi = energy;
            TIA_Param.energylower = energylower;
            TIA_Param.energyupper = energyupper;
            
            % gate_tof
            TIA_Param.gating_tof = gating_tof_64E9M();    % ns
            TIA_Param.gating_timing = gating_timing_64E9M();  % ns
            circle_time = [223229.9054	213140.7401	203661.4242	194950.4347	184947.4916	175625.5676	166938.2894	158842.4419 ...
                               151690.7503	145446.8133	139628.1547	134205.8028	129152.7602	124889.4767	121284.8463 ...
                               118152.504	115820.976	114107.9781	112873.7416	111724.132	111202.7367	110981.8803	 ...
                               110780.1298	110596.4732	110425.8895	110267.4481	110120.2848	109989.144	109868.9088	 ...
                               109757.2321	109653.5046	109557.7453	109475.3356	109398.792	109327.6968	109261.6623	 ...
                               109203.1378	109153.0876	109106.6001	109063.4216	109023.3166	108991.051	108963.2156	 ...
                               108941.243	108924.071	108914.573	108906.4175	108900]; 
             circle_time = [circle_time, NaN(1,16)];  % ns
             N_circle = [10	11	11	12	12	13	14	15	15	16	17	17	18	19	19	20	20	21	21	21	21	21	21	21 ...
                                21	21	21	21	21	21	21	21	21	21	21	21	21	21	21	22	22	22	22	22	22	22	22	22 ];
             N_circle = [N_circle,  NaN(1,16)];

                   
        case 6   % high energy resolution mode-----------------------------------------
            TIA_Param.nmass     = 1;
            TIA_Param.nenergy   = 90 ;
            TIA_Param.naz       = 24;
            TIA_Param.npl       = 9;
            TIA_Param.slot_time = 4.938271605;        % ms
            TIA_Param.mass_num  = [1];  % m/q, the last one is 60-70
            
            % set phi and theta (phi is constant here)
            dphi = 360/TIA_Param.naz; dtht = 90/TIA_Param.npl;
            tht_lower = 0:dtht:90-dtht; 
            tht_upper = tht_lower + dtht;
            theta = (tht_upper+tht_lower)/2;
            phi_lower = 0 : dphi : 360-dphi; 
            phi_upper = phi_lower+dphi;
            phi = (phi_upper+phi_lower)/2;
            TIA_Param.theta = theta;
            TIA_Param.dtht = dtht;
            TIA_Param.tht_lower = tht_lower;
            TIA_Param.tht_upper = tht_upper;
            TIA_Param.phi = phi;
            TIA_Param.dphi = dphi;
            TIA_Param.phi_lower = phi_lower;
            TIA_Param.phi_upper = phi_upper;
            
            % set energy table  (energy and V_ESA are from the payload team)   
           
            
            % gate_tof
            
        case 7   % high angle resolution mode-----------------------------------------------
            TIA_Param.nmass     = 1;
            TIA_Param.nenergy   = 64 ;
            TIA_Param.naz       = 24;
            TIA_Param.npl       = 15;
            TIA_Param.slot_time = 4.166666667;        % ms
            TIA_Param.mass_num  = [1];  % m/q, the last one is 60-70
            
            % set phi and theta (phi is constant here)
            dphi = 360/TIA_Param.naz; dtht = 90/TIA_Param.npl;
            tht_lower = 0:dtht:90-dtht; 
            tht_upper = tht_lower + dtht;
            theta = (tht_upper+tht_lower)/2;
            phi_lower = 0 : dphi : 360-dphi; 
            phi_upper = phi_lower+dphi;
            phi = (phi_upper+phi_lower)/2;
            TIA_Param.theta = theta;
            TIA_Param.dtht = dtht;
            TIA_Param.tht_lower = tht_lower;
            TIA_Param.tht_upper = tht_upper;
            TIA_Param.phi = phi;
            TIA_Param.dphi = dphi;
            TIA_Param.phi_lower = phi_lower;
            TIA_Param.phi_upper = phi_upper;
            
            % set energy table  (energy and V_ESA are from the payload team)   
           
            
            % gate_tof
            
        case 8   % high mass resolution mode (ion energy up to 3 keV)-----------------------
            TIA_Param.nmass     = 9;
            TIA_Param.nenergy   = 48 ;
            TIA_Param.naz       = 24;
            TIA_Param.npl       = 9;
            TIA_Param.slot_time = 4.62962963;        % ms
            TIA_Param.mass_num  = [1,2,4,8,16,32,44,56,70];  % m/q, the last one is 60-70
            
            % set phi and theta (phi is constant here)
            dphi = 360/TIA_Param.naz; dtht = 90/TIA_Param.npl;
            tht_lower = 0:dtht:90-dtht; 
            tht_upper = tht_lower + dtht;
            theta = (tht_upper+tht_lower)/2;
            phi_lower = 0 : dphi : 360-dphi; 
            phi_upper = phi_lower+dphi;
            phi = (phi_upper+phi_lower)/2;
            TIA_Param.theta = theta;
            TIA_Param.dtht = dtht;
            TIA_Param.tht_lower = tht_lower;
            TIA_Param.tht_upper = tht_upper;
            TIA_Param.phi = phi;
            TIA_Param.dphi = dphi;
            TIA_Param.phi_lower = phi_lower;
            TIA_Param.phi_upper = phi_upper;
            
            % set energy table  (energy and V_ESA are from the payload team)   
            energy = [2.79 	3.24 	3.75 	4.36 	5.05 	5.86 	6.80 	7.89 	9.15 	10.62 	12.32 	14.29 	16.58 	19.24 ... 
                            22.32 	25.89 	30.03 	34.84 	40.42 	46.89 	54.40 	63.11 	73.22 	84.94 	98.54 	114.32 	132.62 ... 
                            153.86 	178.49 	207.07 	240.22 	278.69 	323.31 	375.07 	435.13 	504.80 	585.62 	679.39 	788.17 	914.36 ... 
                            1060.76 	1230.61 	1427.64 	1656.23 	1921.41 	2229.05 	2585.95 	3000.00  ];
            V_ESA = [0.50 	0.58 	0.67 	0.78 	0.91 	1.05 	1.22 	1.42 	1.64 	1.91 	2.21 	2.57 	2.98 ...
                            3.45 	4.01 	4.65 	5.39 	6.25 	7.26 	8.42 	9.77 	11.33 	13.14 	15.25 	17.69 ...
                            20.52 	23.81 	27.62 	32.04 	37.17 	43.12 	50.02 	58.03 	67.33 	78.11 	90.61 	105.12 ...
                            121.95 	141.48 	164.13 	190.41 	220.90 	256.26 	297.29 	344.90 	400.12 	464.18 	538.50 ];
            nenergy = TIA_Param.nenergy;
            energyall = log10((energy));
            temp0 = 2*energyall(1)-energyall(2);
            tempe = 2*energyall(end)-energyall(end-1);
            energyall = [temp0 energyall tempe];
            diffenall = diff(energyall);
            energyupper = 10.^(log10(energy)+diffenall(2:1:nenergy+1)/2);
            energylower = 10.^(log10(energy)-diffenall(1:1:nenergy)/2);   
            TIA_Param.Wi = energy;
            TIA_Param.energylower = energylower;
            TIA_Param.energyupper = energyupper;
            
            % gate_tof
            TIA_Param.gating_tof = gating_tof_48E9M();    % ns
            TIA_Param.gating_timing = gating_timing_48E9M();  % ns
            circle_time = [223229.9054	213085.2777	203558.0787	194774.9319	184729.4628	175371.6368	166654.3743	158533.8194 ...	
                                151398.9018	145140.9076	139311.4728	133881.2432	128822.8755	124615.9542	121010.4185	117948.437 ...
                                115618.2095	113985.5805	112753.0545	111605.4985	111176.9534	110956.7401	110756.5551	110573.586 ...
                                110403.7118	110245.9952	110099.5662	109970.2223	109850.6868	109739.7063	109636.6686	109542.8673 ...
                                109461.0739	109385.1343	109314.6296	109249.1709	109192.6554	109143.083	109097.0585	109054.3278 ...
                                109014.6554	108984.4185	108956.9062	108936.9535	108921.1095	108912.4419	108904.3946	108900]; 
             N_circle = [16.00 	16.00 	17.00 	18.00 	19.00 	20.00 	21.00 	22.00 	23.00 	24.00 	25.00 	26.00 	27.00 ...
                                28.00 	29.00 	30.00 	31.00 	31.00 	31.00 	32.00 	32.00 	32.00 	32.00 	32.00 	32.00 ...
                                32.00 	32.00 	32.00 	32.00 	32.00 	32.00 	32.00 	32.00 	32.00 	32.00 	32.00 	32.00 ...
                                32.00 	32.00 	33.00 	33.00 	33.00 	33.00 	33.00 	33.00 	33.00 	33.00 	33.00 ];
       end
      
       %% 64E9M
       %  function:  tof table [mass energy tof_lower(1)/tof_upper(2)]
    function output = gating_tof_64E9M()    %moments
        tof_64E9M = NaN(9, 64,2);    
        tof_64E9M(:, 1, 1) = [140.00    4455.450901    6412.796752    9180.901802    13095.5935    18631.8036    23785.98375    27360.99868    32316.80618];
        tof_64E9M(:, 2, 1) = [140.00    4134.997374    5959.607028    8539.994747    12189.21406    17349.98949    22154.6421    25487.21961    30106.95209];
        tof_64E9M(:, 3, 1) = [140.00    3836.275204    5537.150085    7942.550408    11344.30017    16155.10082    20633.92888    23740.50971    28046.95789];
        tof_64E9M(:, 4, 1) = [140.00    3557.810694    5143.341797    7385.621387    10556.68359    15041.24277    19216.34189    22112.25186    26126.66093];
        tof_64E9M(:, 5, 1) = [140.00    3298.230081    4776.239375    6866.460163    9822.47875    14002.92033    17894.88768    20594.41331    24336.58771];
        tof_64E9M(:, 6, 1) = [140.00    3056.252768    4434.031776    6382.505535    9138.063552    13035.01107    16663.04707    19179.50604    22667.9072];
        tof_64E9M(:, 7, 1) = [140.00    2830.684996    4115.030774    5931.369991    8500.061547    12132.73998    15514.74296    17860.54983    21112.38723];
        tof_64E9M(:, 8, 1) = [140.00    2620.413963    3817.662627    5510.827925    7905.325253    11291.65585    14444.31039    16631.03782    19662.35387];
        tof_64E9M(:, 9, 1) = [140.00    2424.402329    3540.460317    5118.804658    7350.920633    10507.60932    13446.46854    15484.9044    18310.65364];
        tof_64E9M(:, 10, 1) = [140.00    2241.683104    3282.056309    4753.366207    6834.112619    9776.732414    12516.29472    14416.49531    17050.61812];
        tof_64E9M(:, 11, 1) = [140.00    2071.354869    3041.17581    4412.709738    6352.35162    9095.419476    11649.20006    13420.53973    15876.03112];
        tof_64E9M(:, 12, 1) = [140.00    1912.577338    2816.630473    4095.154676    5903.260945    8460.309353    10840.90689    12492.12425    14781.09802];
        tof_64E9M(:, 13, 1) = [140.00    1764.567207    2607.312538    3799.134415    5484.625076    7868.268829    10087.42762    11626.6687    13760.41712];
        tof_64E9M(:, 14, 1) = [140.00    1626.594292    2412.18937    3523.188584    5094.37874    7316.377168    9385.045077    10819.90348    12808.95307];
        tof_64E9M(:, 15, 1) = [140.00    1497.977924    2230.298358    3265.955848    4730.596717    6801.911697    8730.294173    10067.84854    11922.01197];
        tof_64E9M(:, 16, 1) = [140.00    1378.083596    2060.742173    3026.167192    4391.484347    6322.334384    8119.944796    9366.793739    11095.21823];
        tof_64E9M(:, 17, 1) = [140.00    1266.319827    1902.684336    2802.639655    4075.368672    5875.279309    7550.985885    8713.280539    10324.49299];
        tof_64E9M(:, 18, 1) = [140.00    1162.135249    1755.345093    2594.270499    3780.690186    5458.540998    7020.610569    8104.084931    9606.034007];
        tof_64E9M(:, 19, 1) = [140.00    1065.015884    1617.997569    2400.031768    3505.995139    5070.063537    6526.202328    7536.201546    8936.296875];
        tof_64E9M(:, 20, 1) = [140.00    974.4826086    1489.964183    2218.965217    3249.928366    4707.930434    6065.322075    7006.828822    8311.977553];
        tof_64E9M(:, 21, 1) = [140.00    890.088791    1370.613302    2050.177582    3011.226604    4370.355164    5635.696131    6513.35518    7729.996059];
        tof_64E9M(:, 22, 1) = [140.00    811.4180879    1259.356127    1892.836176    2788.712253    4055.672352    5235.205004    6053.346149    7187.481279];
        tof_64E9M(:, 23, 1) = [140.00    738.0823898    1155.643788    1746.16478    2581.287575    3762.329559    4861.872935    5624.532345    6681.756804];
        tof_64E9M(:, 24, 1) = [140.00    669.7199067    1058.964637    1609.439813    2387.929274    3488.879627    4513.85815    5224.798283    6210.32772];
        tof_64E9M(:, 25, 1) = [140.00    605.9933831    968.8417229    1481.986766    2207.683446    3233.973532    4189.443771    4852.17194    5770.868308];
        tof_64E9M(:, 26, 1) = [140.00    546.5884342    884.8304385    1363.176868    2039.660877    2996.353737    3887.029353    4504.815021    5361.210564];
        tof_64E9M(:, 27, 1) = [140.00    491.2119951    806.5163273    1252.42399    1883.032655    2774.84798    3605.122981    4181.013897    4979.333506];
        tof_64E9M(:, 28, 1) = [140.00    439.590875    733.5130391    1149.18175    1737.026078    2568.3635    3342.333915    3879.171145    4623.353205];
        tof_64E9M(:, 29, 1) = [140.00    391.4704091    665.4604237    1052.940818    1600.920847    2375.881637    3097.365727    3597.797673    4291.513487];
        tof_64E9M(:, 30, 1) = [140.00    346.6132029    602.0227543    963.2264058    1474.045509    2196.452812    2869.009906    3335.505369    3982.177274];
        tof_64E9M(:, 31, 1) = [140.00    304.7979603    542.8870711    879.5959206    1355.774142    2029.191841    2656.139892    3091.000254    3693.818505];
        tof_64E9M(:, 32, 1) = [140.00    265.8183925    487.7616377    801.636785    1245.523275    1873.27357    2457.705527    2863.076103    3425.014607];
        tof_64E9M(:, 33, 1) = [140.00    229.4822    436.3745014    728.9644    1142.749003    1727.9288    2272.727866    2650.608487    3174.439479];
        tof_64E9M(:, 34, 1) = [140.00    195.6101238    388.4721519    661.2202477    1046.944304    1592.440495    2100.29435    2452.549231    2940.856949];
        tof_64E9M(:, 35, 1) = [140.00    164.0350616    343.8182706    598.0701231    957.6365412    1466.140246    1939.554306    2267.92124    2723.114673];
        tof_64E9M(:, 36, 1) = [140.00    140.00    302.1925646    539.2024852    874.3851293    1348.40497    1789.714749    2095.813683    2520.138454];
        tof_64E9M(:, 37, 1) = [140.00    140.00    263.3896801    484.3269197    796.7793603    1238.653839    1650.036468    1935.377493    2330.926943];
        tof_64E9M(:, 38, 1) = [140.00    140.00    227.2181892    433.1727067    724.4363785    1136.345413    1519.830384    1785.821183    2154.546692];
        tof_64E9M(:, 39, 1) = [140.00    140.00    193.4996456    382.5163466    652.7974671    1040.97497    1398.454145    1646.406943    1990.12756];
        tof_64E9M(:, 40, 1) = [140.00    140.00    162.0677041    341.036007    594.1354082    952.072014    1285.30896    1516.446993    1836.858408];
        tof_64E9M(:, 41, 1) = [140.00    140.00    140.00    299.5989785    535.5346005    869.197957    1179.836646    1395.300196    1693.98311];
        tof_64E9M(:, 42, 1) = [140.00    140.00    140.00    260.9719764    480.9077703    791.9439529    1081.516871    1282.368894    1560.796811];
        tof_64E9M(:, 43, 1) = [140.00    140.00    140.00    224.9644406    429.9854248    719.9288812    989.8645916    1177.095959    1436.642459];
        tof_64E9M(:, 44, 1) = [140.00    140.00    140.00    191.3987335    382.5163466    652.7974671    904.4276543    1078.962042    1320.907557];
        tof_64E9M(:, 45, 1) = [140.00    140.00    140.00    160.1092641    338.2663546    590.2185282    824.7845701    987.4830165    1213.021146];
        tof_64E9M(:, 46, 1) = [140.00    140.00    140.00    140.00    297.0171484    531.8833413    750.5424323    902.2075843    1112.450986];
        tof_64E9M(:, 47, 1) = [140.00    140.00    140.00    140.00    258.5652315    477.504119    681.3349791    822.7150528    1018.700928];
        tof_64E9M(:, 48, 1) = [140.00    140.00    140.00    140.00    222.7209076    426.81259    616.8207866    748.613258    931.3084724];
       
        tof_64E9M(:, 1, 2) = [4865.450901    6412.796752    9180.901802    11768.07328    17202.17136    23785.98375    27360.99868    32316.80618    37730];
        tof_64E9M(:, 2, 2) = [4544.997374    5959.607028    8539.994747    11000        15950.07058    22154.6421    25487.21961    30106.95209    37730];
        tof_64E9M(:, 3, 2) = [4246.275204    5537.150085    7942.550408    11344.30017    14782.4481    20633.92888    23740.50971    28046.95789    35615.37356];
        tof_64E9M(:, 4, 2) = [3967.810694    5143.341797    7385.621387    10556.68359    13693.60583    19216.34189    22112.25186    26126.66093    33120.5225];
        tof_64E9M(:, 5, 2) = [3708.230081    4776.239375    6866.460163    9822.47875    12678.22991    17894.88768    20594.41331    24336.58771    30794.004];
        tof_64E9M(:, 6, 2) = [3466.252768    4434.031776    6382.505535    9138.063552    11731.3648    16663.04707    19179.50604    22667.9072    28624.46349];
        tof_64E9M(:, 7, 2) = [3240.684996    4115.030774    5931.369991    8500.061547    11000        15514.74296    17860.54983    21112.38723    26601.31208];
        tof_64E9M(:, 8, 2) = [3030.413963    3817.662627    5510.827925    7905.325253    11291.65585    14444.31039    16631.03782    19662.35387    24714.67496];
        tof_64E9M(:, 9, 2) = [2834.402329    3540.460317    5118.804658    7350.920633    10507.60932    13446.46854    15484.9044    18310.65364    22955.34319];
        tof_64E9M(:, 10, 2) = [2651.683104    3282.056309    4753.366207    6834.112619    9776.732414    12516.29472    14416.49531    17050.61812    21314.72892];
        tof_64E9M(:, 11, 2) = [2481.354869    3041.17581    4412.709738    6352.35162    9095.419476    11649.20006    13420.53973    15876.03112    19784.82341];
        tof_64E9M(:, 12, 2) = [2322.577338    2816.630473    4095.154676    5903.260945    8460.309353    10840.90689    12492.12425    14781.09802    18358.15806];
        tof_64E9M(:, 13, 2) = [2174.567207    2607.312538    3799.134415    5484.625076    7868.268829    10087.42762    11626.6687    13760.41712    17027.76797];
        tof_64E9M(:, 14, 2) = [2036.594292    2412.18937    3523.188584    5094.37874    7316.377168    9385.045077    10819.90348    12808.95307    15787.15796];
        tof_64E9M(:, 15, 2) = [1907.977924    2230.298358    3265.955848    4730.596717    6801.911697    8730.294173    10067.84854    11922.01197    14630.27095];
        tof_64E9M(:, 16, 2) = [1788.083596    2060.742173    3026.167192    4391.484347    6322.334384    8119.944796    9366.793739    11095.21823    13551.45837];
        tof_64E9M(:, 17, 2) = [1676.319827    1902.684336    2802.639655    4075.368672    5875.279309    7550.985885    8713.280539    10324.49299    12545.45263];
        tof_64E9M(:, 18, 2) = [1572.135249    1755.345093    2594.270499    3780.690186    5458.540998    7020.610569    8104.084931    9606.034007    11607.34145];
        tof_64E9M(:, 19, 2) = [1475.015884    1617.997569    2400.031768    3505.995139    5070.063537    6526.202328    7536.201546    8936.296875    11000];
        tof_64E9M(:, 20, 2) = [1384.482609    1489.964183    2218.965217    3249.928366    4707.930434    6065.322075    7006.828822    8311.977553    11000];
        tof_64E9M(:, 21, 2) = [1300.088791    1370.613302    2050.177582    3011.226604    4370.355164    5635.696131    6513.35518    7729.996059    11000];
        tof_64E9M(:, 22, 2) = [1221.418088    1259.356127    1892.836176    2788.712253    4055.672352    5235.205004    6053.346149    7187.481279    11000];
        tof_64E9M(:, 23, 2) = [1148.08239    1155.643788    1746.16478    2581.287575    3762.329559    4861.872935    5624.532345    6681.756804    11000];
        tof_64E9M(:, 24, 2) = [1079.719907    1058.964637    1609.439813    2387.929274    3488.879627    4513.85815    5224.798283    6210.32772    11000];
        tof_64E9M(:, 25, 2) = [1015.993383    968.8417229    1481.986766    2207.683446    3233.973532    4189.443771    4852.17194    5770.868308    11000];
        tof_64E9M(:, 26, 2) = [956.5884342    884.8304385    1363.176868    2039.660877    2996.353737    3887.029353    4504.815021    5361.210564    11000];
        tof_64E9M(:, 27, 2) = [901.2119951    806.5163273    1252.42399    1883.032655    2774.84798    3605.122981    4181.013897    4979.333506    11000];
        tof_64E9M(:, 28, 2) = [849.590875    733.5130391    1149.18175    1737.026078    2568.3635    3342.333915    3879.171145    4623.353205    11000];
        tof_64E9M(:, 29, 2) = [801.4704091    665.4604237    1052.940818    1600.920847    2375.881637    3097.365727    3597.797673    4291.513487    11000];
        tof_64E9M(:, 30, 2) = [756.6132029    602.0227543    963.2264058    1474.045509    2196.452812    2869.009906    3335.505369    3982.177274    11000];
        tof_64E9M(:, 31, 2) = [714.7979603    542.8870711    879.5959206    1355.774142    2029.191841    2656.139892    3091.000254    3693.818505    11000];
        tof_64E9M(:, 32, 2) = [675.8183925    487.7616377    801.636785    1245.523275    1873.27357    2457.705527    2863.076103    3425.014607    11000];
        tof_64E9M(:, 33, 2) = [639.4822    436.3745014    728.9644    1142.749003    1727.9288    2272.727866    2650.608487    3174.439479    11000];
        tof_64E9M(:, 34, 2) = [605.6101238    388.4721519    661.2202477    1046.944304    1592.440495    2100.29435    2452.549231    2940.856949    11000];
        tof_64E9M(:, 35, 2) = [574.0350616    343.8182706    598.0701231    957.6365412    1466.140246    1939.554306    2267.92124    2723.114673    11000];
        tof_64E9M(:, 36, 2) = [544.6012426    307.591322    539.2024852    874.3851293    1348.40497    1789.714749    2095.813683    2520.138454    11000];
        tof_64E9M(:, 37, 2) = [517.1634598    296.2262203    484.3269197    796.7793603    1238.653839    1650.036468    1935.377493    2330.926943    11000];
        tof_64E9M(:, 38, 2) = [491.5863533    285.7559031    433.1727067    724.4363785    1136.345413    1519.830384    1785.821183    2154.546692    11000];
        tof_64E9M(:, 39, 2) = [467.7437425    275.7559031    385.4874849    656.9992912    1040.97497    1398.454145    1646.406943    1990.12756    11000];
        tof_64E9M(:, 40, 2) = [445.5180035    266.5497006    341.036007    594.1354082    952.072014    1285.30896    1516.446993    1836.858408    11000];
        tof_64E9M(:, 41, 2) = [424.7994893    257.967811    306.8316782    535.5346005    869.197957    1179.836646    1395.300196    1693.98311    11000];
        tof_64E9M(:, 42, 2) = [405.4859882    249.9678969    295.5180913    480.9077703    791.9439529    1081.516871    1282.368894    1560.796811    11000];
        tof_64E9M(:, 43, 2) = [387.4822203    242.5104921    284.9717282    429.9854248    719.9288812    989.8645916    1177.095959    1436.642459    11000];
        tof_64E9M(:, 44, 2) = [370.6993668    235.5588065    275.1405602    382.5163466    652.7974671    904.4276543    1078.962042    1320.907557    11000];
        tof_64E9M(:, 45, 2) = [355.054632    229.0785452    265.9760868    338.2663546    590.2185282    824.7845701    987.4830165    1213.021146    11000];
        tof_64E9M(:, 46, 2) = [340.4708353    223.0377389    257.4330965    306.0754777    531.8833413    750.5424323    902.2075843    1112.450986    11000];
        tof_64E9M(:, 47, 2) = [326.8760298    217.406586    249.4694437    294.813172    477.504119    681.3349791    822.7150528    1018.700928    11000];
        tof_64E9M(:, 48, 2) = [314.2031475    212.1573063    242.0458412    284.3146126    426.81259    616.8207866    748.613258    931.3084724    11000];

        output = tof_64E9M;
    end

       % function:  gate open/close time [mass energy open(1)/close(2) time]
        function output = gating_timing_64E9M()     %period
            gate_64E9M = NaN(9, 64,2);   
            
            gate_64E9M(:, 1,1) = [346.7741343	490.4126837	693.5482685	980.8253675	1387.096537	1961.650735	2300.239381	2595.020002	3178.237439];
            gate_64E9M(:, 2,1) = [322.0903511	455.5045429	644.1807023	911.0090858	1288.361405	1822.018172	2136.505687	2410.303483	2952.006829];
            gate_64E9M(:, 3,1) = [299.1635882	423.0812038	598.3271764	846.1624076	1196.654353	1692.324815	1984.426746	2238.735299	2741.879576];
            gate_64E9M(:, 4,1) = [277.8687787	392.9657954	555.7375574	785.9315908	1111.475115	1571.863182	1843.17296	2079.379537	2546.709423];
            gate_64E9M(:, 5,1) = [258.0897583	364.9940365	516.1795166	729.988073	1032.359033	1459.976146	1711.973781	1931.366901	2365.431707];
            gate_64E9M(:, 6,1) = [239.7186314	339.0133397	479.4372629	678.0266795	958.8745257	1356.053359	1590.113511	1793.889976	2197.057548];
            gate_64E9M(:, 7,1) = [222.6551826	314.8819789	445.3103651	629.7639579	890.6207303	1259.527916	1476.927396	1666.198817	2040.668456];
            gate_64E9M(:, 8,1) = [206.8063297	292.4683162	413.6126594	584.9366325	827.2253188	1169.873265	1371.798	1547.596862	1895.41132];
            gate_64E9M(:, 9,1) = [192.0856165	271.6500839	384.1712329	543.3001678	768.3424658	1086.600336	1274.151835	1437.437131	1760.493755];
            gate_64E9M(:, 10,1) = [178.4127406	252.3137174	356.8254811	504.6274348	713.6509623	1009.25487	1183.456237	1335.118697	1635.179777];
            gate_64E9M(:, 11,1) = [165.7131158	234.3537358	331.4262315	468.7074716	662.8524631	937.4149432	1099.216456	1240.083407	1518.785793];
            gate_64E9M(:, 12,1) = [153.9174649	217.6721664	307.8349299	435.3443328	615.6698597	870.6886656	1020.97296	1151.812839	1410.676868];
            gate_64E9M(:, 13,1) = [142.9614421	202.1780104	285.9228843	404.3560207	571.8457685	808.7120414	948.2989261	1069.825472	1310.26326];
            gate_64E9M(:, 14,1) = [132.7852817	187.7867462	265.5705633	375.5734925	531.1411267	751.1469849	880.797914	993.6740601	1216.997209];
            gate_64E9M(:, 15,1) = [123.3334721	174.4198689	246.6669441	348.8397378	493.3338883	697.6794756	818.1017019	922.9431936	1130.369943];
            gate_64E9M(:, 16,1) = [114.5544532	162.0044613	229.1089063	324.0089226	458.2178127	648.0178452	759.8682785	857.2470318	1049.908906];
            gate_64E9M(:, 17,1) = [106.400335	150.4727968	212.80067	300.9455935	425.6013399	601.8911871	705.7799774	796.2271987	975.175178];
            gate_64E9M(:, 18,1) = [100	139.7619694	197.6532727	279.5239388	395.3065453	559.0478777	655.541744	739.5508277	905.7610833];
            gate_64E9M(:, 19,1) = [100	129.8135511	183.5840846	259.6271023	367.1681692	519.2542045	608.879526	686.9087462	841.287964];
            gate_64E9M(:, 20,1) = [100	120.5732727	170.5163576	241.1465455	341.0327151	482.2930909	565.5387786	638.0137888	781.4041157];
            gate_64E9M(:, 21,1) = [100	111.990728	158.3788064	223.981456	316.7576128	447.9629121	525.2830756	592.5992309	725.7828689];
            gate_64E9M(:, 22,1) = [100	104.0190987	147.1052202	208.0381975	294.2104404	416.0763949	487.89282	550.4173337	674.1208066];
            gate_64E9M(:, 23,1) = [100	100	136.6341008	193.2297985	273.2682016	386.4595969	453.164046	511.2379926	626.1361095];
            gate_64E9M(:, 24,1) = [100	100	126.9083278	179.4754784	253.8166556	358.9509568	420.9073062	474.8474822	581.5670186];
            gate_64E9M(:, 25,1) = [100	100	117.8748466	166.7002067	235.7496931	333.4004134	390.9466383	441.0472904	540.1704069];
            gate_64E9M(:, 26,1) = [100	100	109.4843789	154.8342936	218.9687579	309.6685871	363.1186054	409.6530352	501.7204539];
            gate_64E9M(:, 27,1) = [100	100	101.6911545	143.8130098	203.382309	287.6260197	337.2714039	380.4934593	466.0074129];
            gate_64E9M(:, 28,1) = [100	100	100	133.5762338	188.9053215	267.1524676	313.2640361	353.4094958	432.8364674];
            gate_64E9M(:, 29,1) = [100	100	100	124.0681233	175.4588227	248.1362466	290.9655405	328.2533999	402.0266681];
            gate_64E9M(:, 30,1) = [100	100	100	115.2368111	162.9694612	230.4736222	270.2542775	304.8879441	373.4099459];
            gate_64E9M(:, 31,1) = [100	100	100	107.0341219	151.3691068	214.0682438	251.0172661	283.1856683	346.8301949];
            gate_64E9M(:, 32,1) = [100	100	100	100	140.5944791	198.8306191	233.1495674	263.0281856	322.1424213];
            gate_64E9M(:, 33,1) = [100	100	100	100	130.5868018	184.6776262	216.5537121	244.3055358	299.211952];
            gate_64E9M(:, 34,1) = [100	100	100	100	121.2914825	171.5320596	201.1391689	226.9155858	277.9136999];
            gate_64E9M(:, 35,1) = [100	100	100	100	112.6578148	159.3222096	186.8218507	210.7634725	258.131482];
            gate_64E9M(:, 36,1) = [100	100	100	100	104.6387015	147.9814708	173.5236557	195.7610852	239.7573852];
            gate_64E9M(:, 37,1) = [100	100	100	100	100	137.4479789	161.1720416	181.8265852	222.6911778];
            gate_64E9M(:, 38,1) = [100	100	100	100	100	127.6642732	149.6996297	168.883959	206.8397627];
            gate_64E9M(:, 39,1) = [100	100	100	100	100	118.5769828	139.0438373	156.8626039	192.1166697];
            gate_64E9M(:, 40,1) = [100	100	100	100	100	110.1365363	129.1465365	145.6969427	178.4415834];
            gate_64E9M(:, 41,1) = [100	100	100	100	100	102.2968906	119.9537369	135.3260662	165.7399055];
            gate_64E9M(:, 42,1) = [100	100	100	100	100	100	111.4152915	125.6934006	153.9423477];
            gate_64E9M(:, 43,1) = [100	100	100	100	100	100	103.4846224	116.7463993	142.9845538];
            gate_64E9M(:, 44,1) = [100	100	100	100	100	100	100	108.4362558	132.8067482];
            gate_64E9M(:, 45,1) = [100	100	100	100	100	100	100	100.717638	123.3534106];
            gate_64E9M(:, 46,1) = [100	100	100	100	100	100	100	100	114.5729724];
            gate_64E9M(:, 47,1) = [100	100	100	100	100	100	100	100	106.417536];
            gate_64E9M(:, 48,1) = [100	100	100	100	100	100	100	100	100];
            
            gate_64E9M(:, 1, 2) = [12000	12000	12000	12768.07328	18202.17136	25887.14656	30415.95403	34358.80533	40000];
            gate_64E9M(:, 2, 2) = [12000	12000	12000	12000	16950.07058	24116.40866	28339.57979	32016.33927	39290.73277];
            gate_64E9M(:, 3, 2) = [12000	12000	12000	12000	15782.4481	22465.14111	26403.29696	29831.91762	36615.37356];
            gate_64E9M(:, 4, 2) = [12000	12000	12000	12000	14693.60583	20925.2856	24597.65632	27794.88026	34120.5225];
            gate_64E9M(:, 5, 2) = [12000	12000	12000	12000	13678.22991	19489.32721	22913.84585	25895.28586	31794.004];
            gate_64E9M(:, 6, 2) = [12000	12000	12000	12000	12731.3648	18150.25773	21343.64771	24123.86345	29624.46349];
            gate_64E9M(:, 7, 2) = [12000	12000	12000	12000	12000	16901.54158	19879.39823	22471.96725	27601.31208];
            gate_64E9M(:, 8, 2) = [12000	12000	12000	12000	12000	15737.08386	18513.95052	20931.53448	25714.67496];
            gate_64E9M(:, 9, 2) = [12000	12000	12000	12000	12000	14651.20072	17240.63967	19495.04611	23955.34319];
            gate_64E9M(:, 10, 2) = [12000	12000	12000	12000	12000	13638.59161	16053.25023	18155.49017	22314.72892];
            gate_64E9M(:, 11, 2) = [12000	12000	12000	12000	12000	12694.31342	14945.98592	16906.32755	20784.82341];
            gate_64E9M(:, 12, 2) = [12000	12000	12000	12000	12000	12000	13913.44135	15741.46017	19358.15806];
            gate_64E9M(:, 13, 2) = [12000	12000	12000	12000	12000	12000	12950.57569	14655.20121	18027.76797];
            gate_64E9M(:, 14, 2) = [12000	12000	12000	12000	12000	12000	12052.68809	13642.24738	16787.15796];
            gate_64E9M(:, 15, 2) = [12000	12000	12000	12000	12000	12000	12000	12697.65309	15630.27095];
            gate_64E9M(:, 16, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	14551.45837];
            gate_64E9M(:, 17, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	13545.45263];
            gate_64E9M(:, 18, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12607.34145];
            gate_64E9M(:, 19, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 20, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 21, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 22, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 23, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 24, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 25, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 26, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 27, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 28, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 29, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 30, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 31, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 32, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 33, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 34, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 35, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 36, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 37, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 38, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 39, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 40, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 41, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 42, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 43, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 44, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 45, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 46, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 47, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];
            gate_64E9M(:, 48, 2) = [12000	12000	12000	12000	12000	12000	12000	12000	12000];

            output = gate_64E9M;
        end
       %% 48E9M
    function output = gating_tof_48E9M()    %moments
        tof_48E9M = NaN(9, 48, 2);
        
        tof_48E9M(:, 1, 1) = [120.00    4455.45    6412.80    9180.90    13095.59    18631.80    23785.98    27361.00    32316.81];
        tof_48E9M(:, 2, 1) = [120.00    4133.25    5957.14    8536.50    12184.27    17343.00    22145.75    25477.00    30094.90];
        tof_48E9M(:, 3, 1) = [120.00    3833.02    5532.54    7936.04    11335.09    16142.07    20617.35    23721.46    28024.50];
        tof_48E9M(:, 4, 1) = [120.00    3553.26    5136.90    7376.51    10543.80    15023.03    19193.16    22085.62    26095.26];
        tof_48E9M(:, 5, 1) = [120.00    3292.57    4768.24    6855.14    9806.47    13980.29    17866.08    20561.32    24297.56];
        tof_48E9M(:, 6, 1) = [120.00    3049.66    4424.71    6369.32    9119.42    13008.64    16629.49    19140.96    22622.45];
        tof_48E9M(:, 7, 1) = [120.00    2823.31    4104.60    5916.62    8479.21    12103.25    15477.21    17817.44    21061.54];
        tof_48E9M(:, 8, 1) = [120.00    2612.40    3806.32    5494.79    7882.65    11259.59    14403.50    16584.16    19607.07];
        tof_48E9M(:, 9, 1) = [120.00    2415.86    3528.38    5101.73    7326.77    10473.45    13403.00    15434.97    18251.77];
        tof_48E9M(:, 10, 1) = [120.00    2232.73    3269.39    4735.46    6808.79    9740.92    12470.72    14364.14    16988.88];
        tof_48E9M(:, 11, 1) = [120.00    2062.08    3028.06    4394.17    6326.13    9058.33    11602.00    13366.33    15812.09];
        tof_48E9M(:, 12, 1) = [120.00    1903.07    2803.19    4076.14    5876.38    8422.29    10792.52    12436.54    14715.55];
        tof_48E9M(:, 13, 1) = [120.00    1754.90    2593.65    3779.81    5457.29    7829.61    10038.23    11570.16    13693.77];
        tof_48E9M(:, 14, 1) = [120.00    1616.84    2398.39    3503.67    5066.78    7277.35    9335.37    10762.85    12741.66];
        tof_48E9M(:, 15, 1) = [120.00    1488.18    2216.45    3246.37    4702.90    6762.74    8680.44    10010.58    11854.47];
        tof_48E9M(:, 16, 1) = [120.00    1368.30    2046.91    3006.61    4363.82    6283.21    8070.16    9309.61    11027.78];
        tof_48E9M(:, 17, 1) = [120.00    1256.60    1888.93    2783.19    4047.87    5836.39    7501.49    8656.43    10257.45];
        tof_48E9M(:, 18, 1) = [120.00    1152.51    1741.73    2575.02    3753.46    5420.03    6971.60    8047.79    9539.64];
        tof_48E9M(:, 19, 1) = [120.00    1055.52    1604.56    2381.03    3479.12    5032.06    6477.84    7480.65    8870.78];
        tof_48E9M(:, 20, 1) = [120.00    965.14    1476.75    2200.27    3223.49    4670.54    6017.74    6952.18    8247.52];
        tof_48E9M(:, 21, 1) = [120.00    880.92    1357.65    2031.84    2985.29    4333.68    5589.02    6459.74    7666.76];
        tof_48E9M(:, 22, 1) = [120.00    802.44    1246.67    1874.89    2763.33    4019.78    5189.52    6000.88    7125.60];
        tof_48E9M(:, 23, 1) = [120.00    729.32    1143.25    1728.64    2556.51    3727.28    4817.27    5573.30    6621.34];
        tof_48E9M(:, 24, 1) = [120.00    661.18    1046.89    1592.37    2363.78    3454.73    4470.40    5174.88    6151.46];
        tof_48E9M(:, 25, 1) = [120.00    597.69    957.10    1465.38    2184.20    3200.76    4147.18    4803.63    5713.62];
        tof_48E9M(:, 26, 1) = [120.00    538.53    873.43    1347.06    2016.86    2964.11    3846.00    4457.68    5305.63];
        tof_48E9M(:, 27, 1) = [120.00    483.40    795.47    1236.80    1860.94    2743.60    3565.35    4135.33    4925.46];
        tof_48E9M(:, 28, 1) = [120.00    432.03    722.82    1134.06    1715.64    2538.12    3303.84    3834.96    4571.21];
        tof_48E9M(:, 29, 1) = [120.00    384.16    655.13    1038.32    1580.25    2346.65    3060.16    3555.06    4241.12];
        tof_48E9M(:, 30, 1) = [120.00    339.56    592.05    949.12    1454.09    2168.23    2833.10    3294.26    3933.53];
        tof_48E9M(:, 31, 1) = [120.00    298.00    533.27    865.99    1336.54    2001.99    2621.51    3051.23    3646.91];
        tof_48E9M(:, 32, 1) = [120.00    259.27    478.50    788.54    1227.00    1847.07    2424.36    2824.77    3379.84];
        tof_48E9M(:, 33, 1) = [120.00    223.18    427.46    716.36    1124.92    1702.72    2240.65    2613.76    3130.98];
        tof_48E9M(:, 34, 1) = [120.00    189.55    379.91    649.11    1029.81    1568.21    2069.46    2417.13    2899.09];
        tof_48E9M(:, 35, 1) = [120.00    158.22    335.59    586.44    941.19    1442.88    1909.95    2233.91    2683.01];
        tof_48E9M(:, 36, 1) = [120.00    129.02    294.30    528.04    858.60    1326.08    1761.31    2063.19    2481.66];
        tof_48E9M(:, 37, 1) = [120.00    120.00    255.82    473.63    781.65    1217.26    1622.81    1904.10    2294.04];
        tof_48E9M(:, 38, 1) = [120.00    120.00    219.97    422.92    709.94    1115.85    1493.75    1755.86    2119.21];
        tof_48E9M(:, 39, 1) = [120.00    120.00    186.56    375.68    643.13    1021.36    1373.49    1617.73    1956.31];
        tof_48E9M(:, 40, 1) = [120.00    120.00    155.43    331.65    580.87    933.31    1261.43    1489.02    1804.51];
        tof_48E9M(:, 41, 1) = [120.00    120.00    126.43    290.63    522.85     851.26    1157.01    1369.08    1663.06];
        tof_48E9M(:, 42, 1) = [120.00    120.00    120.00    252.40    468.79    774.81    1059.71    1257.32    1531.25];
        tof_48E9M(:, 43, 1) = [120.00    120.00    120.00    216.78    418.42    703.57    969.04    1153.18    1408.44];
        tof_48E9M(:, 44, 1) = [120.00    120.00    120.00    183.59    371.48    637.19    884.56    1056.14    1293.99];
        tof_48E9M(:, 45, 1) = [120.00    120.00    120.00    152.67    327.74    575.33    805.84    965.72    1187.35];
        tof_48E9M(:, 46, 1) = [120.00    120.00    120.00    123.85    286.98    517.69    732.48    881.46    1087.99];
        tof_48E9M(:, 47, 1) = [120.00    120.00    120.00    120.00    249.01    463.98    664.13    802.95    995.39];
        tof_48E9M(:, 48, 1) = [120.00    120.00    120.00    120.00    213.62    413.94    600.44    729.79    909.11];
        
        tof_48E9M(:, 1, 2) = [4845.45 	6412.80 	9180.90 	11768.07 	17202.17 	23785.98 	27361.00 	32316.81 	37730.00];
        tof_48E9M(:, 2, 2) = [4523.25 	5957.14 	8536.50 	11000.00 	15943.24 	22145.75 	25477.00 	30094.90 	37730.00];
        tof_48E9M(:, 3, 2) = [4223.02 	5532.54 	7936.04 	11335.09 	14769.71 	20617.35 	23721.46 	28024.50 	35586.20];
        tof_48E9M(:, 4, 2) = [3943.26 	5136.90 	7376.51 	10543.80 	13675.80 	19193.16 	22085.62 	26095.26 	33079.72];
        tof_48E9M(:, 5, 2) = [3682.57 	4768.24 	6855.14 	9806.47 	12656.09 	17866.08 	20561.32 	24297.56 	30743.28];
        tof_48E9M(:, 6, 2) = [3439.66 	4424.71 	6369.32 	9119.42 	11705.56 	16629.49 	19140.96 	22622.45 	28565.34];
        tof_48E9M(:, 7, 2) = [3213.31 	4104.60 	5916.62 	8479.21 	11000.00 	15477.21 	17817.44 	21061.54 	26535.17];
        tof_48E9M(:, 8, 2) = [3002.40 	3806.32 	5494.79 	7882.65 	11259.59 	14403.50 	16584.16 	19607.07 	24642.73];
        tof_48E9M(:, 9, 2) = [2805.86 	3528.38 	5101.73 	7326.77 	10473.45 	13403.00 	15434.97 	18251.77 	22878.68];
        tof_48E9M(:, 10, 2) = [2622.73 	3269.39 	4735.46 	6808.79 	9740.92 	12470.72 	14364.14 	16988.88 	21234.32];
        tof_48E9M(:, 11, 2) = [2452.08 	3028.06 	4394.17 	6326.13 	9058.33 	11602.00 	13366.33 	15812.09 	19701.53];
        tof_48E9M(:, 12, 2) = [2293.07 	2803.19 	4076.14 	5876.38 	8422.29 	10792.52 	12436.54 	14715.55 	18272.73];
        tof_48E9M(:, 13, 2) = [2144.90 	2593.65 	3779.81 	5457.29 	7829.61 	10038.23 	11570.16 	13693.77 	16940.88];
        tof_48E9M(:, 14, 2) = [2006.84 	2398.39 	3503.67 	5066.78 	7277.35 	9335.37 	10762.85 	12741.66 	15699.40];
        tof_48E9M(:, 15, 2) = [1878.18 	2216.45 	3246.37 	4702.90 	6762.74 	8680.44 	10010.58 	11854.47 	14542.16];
        tof_48E9M(:, 16, 2) = [1758.30 	2046.91 	3006.61 	4363.82 	6283.21 	8070.16 	9309.61 	11027.78 	13463.44];
        tof_48E9M(:, 17, 2) = [1646.60 	1888.93 	2783.19 	4047.87 	5836.39 	7501.49 	8656.43 	10257.45 	12457.92];
        tof_48E9M(:, 18, 2) = [1542.51 	1741.73 	2575.02 	3753.46 	5420.03 	6971.60 	8047.79 	9539.64 	11520.63];
        tof_48E9M(:, 19, 2) = [1445.52 	1604.56 	2381.03 	3479.12 	5032.06 	6477.84 	7480.65 	8870.78 	11000.00];
        tof_48E9M(:, 20, 2) = [1355.14 	1476.75 	2200.27 	3223.49 	4670.54 	6017.74 	6952.18 	8247.52 	11000.00];
        tof_48E9M(:, 21, 2) = [1270.92 	1357.65 	2031.84 	2985.29 	4333.68 	5589.02 	6459.74 	7666.76 	11000.00];
        tof_48E9M(:, 22, 2) = [1192.44 	1246.67 	1874.89 	2763.33 	4019.78 	5189.52 	6000.88 	7125.60 	11000.00];
        tof_48E9M(:, 23, 2) = [1119.32 	1143.25 	1728.64 	2556.51 	3727.28 	4817.27 	5573.30 	6621.34 	11000.00];
        tof_48E9M(:, 24, 2) = [1051.18 	1046.89 	1592.37 	2363.78 	3454.73 	4470.40 	5174.88 	6151.46 	11000.00];
        tof_48E9M(:, 25, 2) = [987.69 	957.10 	1465.38 	2184.20 	3200.76 	4147.18 	4803.63 	5713.62 	11000.00];
        tof_48E9M(:, 26, 2) = [928.53 	873.43 	1347.06 	2016.86 	2964.11 	3846.00 	4457.68 	5305.63 	11000.00];
        tof_48E9M(:, 27, 2) = [873.40 	795.47 	1236.80 	1860.94 	2743.60 	3565.35 	4135.33 	4925.46 	11000.00];
        tof_48E9M(:, 28, 2) = [822.03 	722.82 	1134.06 	1715.64 	2538.12 	3303.84 	3834.96 	4571.21 	11000.00];
        tof_48E9M(:, 29, 2) = [774.16 	655.13 	1038.32 	1580.25 	2346.65 	3060.16 	3555.06 	4241.12 	11000.00];
        tof_48E9M(:, 30, 2) = [729.56 	592.05 	949.12 	1454.09 	2168.23 	2833.10 	3294.26 	3933.53 	11000.00];
        tof_48E9M(:, 31, 2) = [688.00 	533.27 	865.99 	1336.54 	2001.99 	2621.51 	3051.23 	3646.91 	11000.00];
        tof_48E9M(:, 32, 2) = [649.27 	478.50 	788.54 	1227.00 	1847.07 	2424.36 	2824.77 	3379.84 	11000.00];
        tof_48E9M(:, 33, 2) = [613.18 	427.46 	716.36 	1124.92 	1702.72 	2240.65 	2613.76 	3130.98 	11000.00];
        tof_48E9M(:, 34, 2) = [579.55 	379.91 	649.11 	1029.81 	1568.21 	2069.46 	2417.13 	2899.09 	11000.00];
        tof_48E9M(:, 35, 2) = [548.22 	335.59 	586.44 	941.19 	1442.88 	1909.95 	2233.91 	2683.01 	11000.00];
        tof_48E9M(:, 36, 2) = [519.02 	294.30 	528.04 	858.60 	1326.08 	1761.31 	2063.19 	2481.66 	11000.00];
        tof_48E9M(:, 37, 2) = [491.81 	274.01 	473.63 	781.65 	1217.26 	1622.81 	1904.10 	2294.04 	11000.00];
        tof_48E9M(:, 38, 2) = [466.46 	263.51 	422.92 	709.94 	1115.85 	1493.75 	1755.86 	2119.21 	11000.00];
        tof_48E9M(:, 39, 2) = [442.84 	253.72 	375.68 	643.13 	1021.36 	1373.49 	1617.73 	1956.31 	11000.00];
        tof_48E9M(:, 40, 2) = [420.83 	244.61 	331.65 	580.87 	933.31 	1261.43 	1489.02 	1804.51 	11000.00];
        tof_48E9M(:, 41, 2) = [400.32 	236.11 	290.63 	522.85 	851.26 	1157.01 	1369.08 	1663.06 	11000.00];
        tof_48E9M(:, 42, 2) = [381.20 	228.19 	273.01 	468.79 	774.81 	1059.71 	1257.32 	1531.25 	11000.00];
        tof_48E9M(:, 43, 2) = [363.39 	220.82 	262.58 	418.42 	703.57 	969.04 	1153.18 	1408.44 	11000.00];
        tof_48E9M(:, 44, 2) = [346.80 	213.94 	252.85 	371.48 	637.19 	884.56 	1056.14 	1293.99 	11000.00];
        tof_48E9M(:, 45, 2) = [331.33 	207.54 	243.80 	327.74 	575.33 	805.84 	965.72 	1187.35 	11000.00];
        tof_48E9M(:, 46, 2) = [316.92 	201.57 	235.35 	286.98 	517.69 	732.48 	881.46 	1087.99 	11000.00];
        tof_48E9M(:, 47, 2) = [303.50 	196.01 	227.49 	272.01 	463.98 	664.13 	802.95 	995.39 	11000.00];
        tof_48E9M(:, 48, 2) = [290.98 	190.82 	220.16 	261.65 	413.94 	600.44 	729.79 	909.11 	11000.00];
        output = tof_48E9M;
    end

       function output = gating_timing_48E9M()     %period
            gate_48E9M = NaN(9, 48,2);   
            
            gate_48E9M(:, 1, 1) = [346.77 490.41 693.55 980.83 1387.10 1961.65 2300.24 2595.02 3178.24];
            gate_48E9M(:, 2, 1) = [321.96 455.31 643.91 910.63 1287.82 1821.26 2135.61 2409.30 2950.78];
            gate_48E9M(:, 3, 1) = [298.91 422.73 597.83 845.46 1195.66 1690.91 1982.77 2236.87 2739.59];
            gate_48E9M(:, 4, 1) = [277.52 392.47 555.04 784.95 1110.08 1569.90 1840.87 2076.78 2543.52];
            gate_48E9M(:, 5, 1) = [257.66 364.39 515.32 728.77 1030.64 1457.54 1709.12 1928.15 2361.49];
            gate_48E9M(:, 6, 1) = [239.22 338.31 478.44 676.61 956.88 1353.23 1586.80 1790.15 2192.48];
            gate_48E9M(:, 7, 1) = [222.10 314.09 444.20 628.19 888.39 1256.38 1473.23 1662.03 2035.57];
            gate_48E9M(:, 8, 1) = [206.20 291.62 412.41 583.23 824.81 1166.46 1367.80 1543.08 1889.88];
            gate_48E9M(:, 9, 1) = [191.45 270.74 382.89 541.49 765.78 1082.98 1269.91 1432.65 1754.63];
            gate_48E9M(:, 10, 1) = [177.74 251.37 355.49 502.74 710.98 1005.47 1179.02 1330.11 1629.05];
            gate_48E9M(:, 11, 1) = [165.02 233.38 330.05 466.76 660.09 933.51 1094.64 1234.92 1512.46];
            gate_48E9M(:, 12, 1) = [153.21 216.68 306.43 433.35 612.85 866.70 1016.30 1146.54 1404.22];
            gate_48E9M(:, 13, 1) = [142.25 201.17 284.49 402.34 568.99 804.67 943.56 1064.48 1303.72];
            gate_48E9M(:, 14, 1) = [132.07 186.77 264.13 373.54 528.27 747.08 876.03 988.30 1210.41];
            gate_48E9M(:, 15, 1) = [122.62 173.40 245.23 346.81 490.46 693.62 813.34 917.57 1123.79];
            gate_48E9M(:, 16, 1) = [113.84 160.99 227.68 321.99 455.36 643.97 755.13 851.90 1043.36];
            gate_48E9M(:, 17, 1) = [105.69 149.47 211.38 298.94 422.77 597.89 701.08 790.93 968.69];
            gate_48E9M(:, 18, 1) = [100.00 138.77 196.26 277.55 392.51 555.10 650.91 734.32 899.36];
            gate_48E9M(:, 19, 1) = [100.00 128.84 182.21 257.68 364.42 515.37 604.32 681.77 834.99];
            gate_48E9M(:, 20, 1) = [100.00 119.62 169.17 239.24 338.34 478.48 561.07 632.98 775.23];
            gate_48E9M(:, 21, 1) = [100.00 111.06 157.06 222.12 314.13 444.24 520.92 587.67 719.75];
            gate_48E9M(:, 22, 1) = [100.00 103.11 145.82 206.22 291.64 412.45 483.64 545.62 668.24];
            gate_48E9M(:, 23, 1) = [100.00 100.00 135.39 191.46 270.77 382.93 449.02 506.57 620.42];
            gate_48E9M(:, 24, 1) = [100.00 100.00 125.70 177.76 251.39 355.52 416.89 470.31 576.01];
            gate_48E9M(:, 25, 1) = [100.00 100.00 116.70 165.04 233.40 330.08 387.05 436.65 534.79];
            gate_48E9M(:, 26, 1) = [100.00 100.00 108.35 153.23 216.70 306.46 359.35 405.40 496.51];
            gate_48E9M(:, 27, 1) = [100.00 100.00 100.59 142.26 201.19 284.52 333.63 376.39 460.98];
            gate_48E9M(:, 28, 1) = [100.00 100.00 100.00 132.08 186.79 264.16 309.75 349.45 427.99];
            gate_48E9M(:, 29, 1) = [100.00 100.00 100.00 122.63 173.42 245.25 287.59 324.44 397.36];
            gate_48E9M(:, 30, 1) = [100.00 100.00 100.00 113.85 161.01 227.70 267.00 301.22 368.92];
            gate_48E9M(:, 31, 1) = [100.00 100.00 100.00 105.70 149.49 211.41 247.89 279.66 342.52];
            gate_48E9M(:, 32, 1) = [100.00 100.00 100.00 100.00 138.79 196.28 230.15 259.65 318.00];
            gate_48E9M(:, 33, 1) = [100.00 100.00 100.00 100.00 128.85 182.23 213.68 241.07 295.24];
            gate_48E9M(:, 34, 1) = [100.00 100.00 100.00 100.00 119.63 169.19 198.39 223.81 274.11];
            gate_48E9M(:, 35, 1) = [100.00 100.00 100.00 100.00 111.07 157.08 184.19 207.79 254.50];
            gate_48E9M(:, 36, 1) = [100.00 100.00 100.00 100.00 103.12 145.84 171.01 192.92 236.28];
            gate_48E9M(:, 37, 1) = [100.00 100.00 100.00 100.00 100.00 135.40 158.77 179.12 219.37];
            gate_48E9M(:, 38, 1) = [100.00 100.00 100.00 100.00 100.00 125.71 147.41 166.30 203.67];
            gate_48E9M(:, 39, 1) = [100.00 100.00 100.00 100.00 100.00 116.71 136.86 154.40 189.09];
            gate_48E9M(:, 40, 1) = [100.00 100.00 100.00 100.00 100.00 108.36 127.06 143.35 175.56];
            gate_48E9M(:, 41, 1) = [100.00 100.00 100.00 100.00 100.00 100.60 117.97 133.09 163.00];
            gate_48E9M(:, 42, 1) = [100.00 100.00 100.00 100.00 100.00 100.00 109.53 123.56 151.33];
            gate_48E9M(:, 43, 1) = [100.00 100.00 100.00 100.00 100.00 100.00 101.69 114.72 140.50];
            gate_48E9M(:, 44, 1) = [100.00 100.00 100.00 100.00 100.00 100.00 100.00 106.51 130.45];
            gate_48E9M(:, 45, 1) = [100.00 100.00 100.00 100.00 100.00 100.00 100.00 100.00 121.11];
            gate_48E9M(:, 46, 1) = [100.00 100.00 100.00 100.00 100.00 100.00 100.00 100.00 112.44];
            gate_48E9M(:, 47, 1) = [100.00 100.00 100.00 100.00 100.00 100.00 100.00 100.00 104.39];
            gate_48E9M(:, 48, 1) = [100.00 100.00 100.00 100.00 100.00 100.00 100.00 100.00 100.00];

            
            gate_48E9M(:, 1, 2) = [12000.00 12000.00 12000.00 12768.07 18202.17 25887.15 30415.95 34358.81 40000.00];
            gate_48E9M(:, 2, 2) = [12000.00 12000.00 12000.00 12000.00 16943.24 24106.75 28328.25 32003.56 39275.09];
            gate_48E9M(:, 3, 2) = [12000.00 12000.00 12000.00 12000.00 15769.71 22447.13 26382.18 29808.09 36586.20];
            gate_48E9M(:, 4, 2) = [12000.00 12000.00 12000.00 12000.00 14675.80 20900.10 24568.12 27761.56 34079.72];
            gate_48E9M(:, 5, 2) = [12000.00 12000.00 12000.00 12000.00 13656.09 19458.02 22877.13 25853.87 31743.28];
            gate_48E9M(:, 6, 2) = [12000.00 12000.00 12000.00 12000.00 12705.56 18113.77 21300.86 24075.59 29565.34];
            gate_48E9M(:, 7, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 16860.72 19831.53 22417.96 27535.17];
            gate_48E9M(:, 8, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 15692.68 18461.88 20872.79 25642.73];
            gate_48E9M(:, 9, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 14603.89 17185.16 19432.45 23878.68];
            gate_48E9M(:, 10, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 13588.96 15995.06 18089.84 22234.32];
            gate_48E9M(:, 11, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12642.90 14885.70 16838.32 20701.53];
            gate_48E9M(:, 12, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 13851.62 15671.71 19272.73];
            gate_48E9M(:, 13, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12887.69 14584.26 17940.88];
            gate_48E9M(:, 14, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 13570.59 16699.40];
            gate_48E9M(:, 15, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12625.71 15542.16];
            gate_48E9M(:, 16, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 14463.44];
            gate_48E9M(:, 17, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 13457.92];
            gate_48E9M(:, 18, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12520.63];
            gate_48E9M(:, 19, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 20, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 21, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 22, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 23, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 24, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 25, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 26, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 27, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 28, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 29, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 30, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 31, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 32, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 33, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 34, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 35, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 36, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 37, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 38, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 39, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 40, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 41, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 42, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 43, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 44, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 45, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 46, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 47, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];
            gate_48E9M(:, 48, 2) = [12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00 12000.00];

            output = gate_48E9M;
        end
       
end
       